import{a as R}from"./clsx-B6oeREpB.js";import{r as j,l as e,t as M}from"./chunk-HA7DTUK3-DrNZtXfs.js";import{a as B,O as G}from"./index-iu7M0T5d.js";import{u as _}from"./useQuery-CtBUlfUK.js";import{b as D}from"./http-dO_zUEib.js";import{c as q}from"./Utils-6MWpJHdW.js";import{u as K}from"./useMutation-B2YuRMgo.js";import{c as W,b as U,a as b,d as J,u as Q,I as w,S as H,A as X,T as Y}from"./SelectionTile-0E2oa7a7.js";import{u as Z}from"./index-Dq7Ccb3X.js";import{O as F}from"./index-C28QBG-a.js";import{F as ee}from"./index-DEy9Fy6Y.js";import{A as T}from"./index-DpCQFZnQ.js";import{_ as g}from"./lodash-BD8GlHKQ.js";import{B as r}from"./Box-lkY65lPb.js";import{T as a}from"./Typography-B2rbqJ1w.js";import{I as le}from"./IconButton-DXjjp29i.js";import{A as V}from"./ArrowLeft-B3jdeqEj.js";import{E as O}from"./Edit-C_PGWcdJ.js";import{F as re}from"./Folder-BofwNFmG.js";import{t as se,a as te,b as oe,c as ne,d as ie,e as ae}from"./chunk-F3UDT23P-CmcUTUZk.js";import{s as ce}from"./chunk-MSDKUXDP-1VvPWETC.js";import{A as ue}from"./AddSquare-CjJD8fbj.js";import"./DefaultPropsProvider-VWusWl-V.js";import"./useId-SEqUg4rG.js";import"./QueryClientProvider-BzrRjjnv.js";import"./query-CBXnY91v.js";import"./middleware-BV1xb2r4.js";import"./useSlotProps-DDXBCOCJ.js";import"./index-DXNBG3AJ.js";import"./useEnhancedEffect-D5gkRMlx.js";import"./mutation-z2A7xQGH.js";import"./useFormControl-CMHJfVNu.js";import"./AssetsManager-DzM0beEI.js";import"./TickCircle-Br5amtOW.js";import"./chunk-TLYTI3QM-OrR10yBI.js";import"./index-Pb_fgjA9.js";import"./openLink-BWM6VQda.js";import"./proxy-_zQbSCat.js";import"./filter-props-CDQEcbTi.js";import"./useLabels-VaBGDf9e.js";import"./ArrowRight2-DORB6AHs.js";import"./chunk-SLABUSGS-B28E3abK.js";const xe=W().shape({name:b().required("Please enter plugin name."),official:J().required("Plugin type is required."),sourcePattern:b().nullable(),versionSources:U().of(W().shape({version:b().required("Version is required."),source:b().required("Source is required.")})).required()}),pe={name:"",official:!1,sourcePattern:null,versionSources:[]};function de({onBack:n,isAdd:i}){return e.jsx(T,{items:[{label:"Go back",icon:e.jsx(V,{size:"14px",color:"currentColor"}),onClick:n},{label:i?"Add plugin":"Edit plugin",color:"#BDA0FF"}]})}function L({isOpen:n,onOpenChange:i,pluginName:u}){const[v,S]=j.useState(pe),l=Q({initialValues:v,enableReinitialize:!0,validationSchema:xe,onSubmit:async o=>{y(o)}}),{mutate:y,isPending:s}=K({mutationKey:["save-plugin"],mutationFn:async o=>{const t={name:o.name,official:o.official,sourcePattern:o.sourcePattern,versionSources:o.versionSources.reduce((x,{version:f,source:c})=>(x[f]=c,x),{})};await D.post("/plugin-artifacts",t),Z.success("Plugin saved successfully")}});j.useEffect(()=>{n&&(l.resetForm(),I())},[n]);const d=async()=>{if(!u)return null;const o=await D.get(`/plugin-artifacts/${u}`),{name:t,official:x,sourcePattern:f,versionSources:c}=o.data;S({name:t,official:x,sourcePattern:f,versionSources:c==null?[]:Object.keys(c).map(h=>({version:h,source:c[h]}))}),l.resetForm()},{isLoading:A,isRefetching:N,refetch:I}=_({queryKey:["get-plugin-info"],queryFn:d,staleTime:0});return e.jsxs(ee,{isOpen:n,onOpenChange:i,children:[e.jsx(r,{minHeight:"58px"}),e.jsxs("form",{onSubmit:l.handleSubmit,onReset:l.handleReset,className:"flex flex-col gap-2 w-full",children:[e.jsxs(r,{className:"flex items-center gap-3 justify-between",children:[e.jsx(de,{onBack:i,isAdd:!u}),e.jsx(B,{type:"submit",disabled:!l.dirty||l.isSubmitting||s,children:"Save plugin"})]}),e.jsx(r,{className:"flex p-px rounded-2xl h-[calc(var(--window-height)-120px)]",sx:{background:"radial-gradient(#6E687C, #1D1D1D)"},children:e.jsx(r,{className:"flex flex-col gap-6 pt-6 rounded-2xl bg-[#0D0D0D] w-full h-full items-start",children:e.jsx(r,{className:"flex flex-col h-full w-full gap-3 overflow-auto items-center",padding:"0px 32px 24px 32px",children:e.jsx(r,{className:"flex flex-col max-w-[552px] w-full",children:e.jsxs(r,{className:"flex flex-col items-stretch gap-6 max-w-[552px] w-full",children:[e.jsxs(r,{className:"flex flex-col gap-[6px] max-w-[515px]",children:[e.jsx(a,{color:"#ABA9B1",fontSize:"14px",fontWeight:"400",lineHeight:"20px",children:"Plugin name"}),e.jsx(r,{className:"flex flex-col gap-[6px]",children:e.jsx(F,{show:A||N,height:"52px",className:"w-full rounded-[10px]",component:e.jsx(w,{fullWidth:!0,id:"name",name:"name",type:"text",placeholder:"Enter plugin name",variant:"outlined",value:l.values.name,onChange:l.handleChange,onBlur:l.handleBlur,error:l.touched.name&&!!l.errors.name,helperText:l.touched.name&&l.errors.name})})})]}),e.jsxs(r,{className:"flex flex-col gap-[6px] max-w-[515px]",children:[e.jsx(a,{color:"#ABA9B1",fontSize:"14px",fontWeight:"400",lineHeight:"20px",children:"Plugin type"}),e.jsx(F,{show:A||N,component:e.jsxs(r,{className:"flex flex-col gap-[2px] w-full",children:[e.jsxs(r,{className:"flex flex-row gap-2 justify-between",children:[e.jsx(H,{label:"Official",isSelected:l.values.official,value:"official",onSelect:o=>l.setFieldValue("official",!0)}),e.jsx(H,{label:"3rd party",isSelected:!l.values.official,value:"3rd party",onSelect:o=>l.setFieldValue("official",!1)})]}),l.touched.official&&l.errors.official?e.jsx(a,{fontSize:"12px",fontWeight:400,lineHeight:"20px",color:"#ef4444",children:l.touched.official&&l.errors.official}):null]}),height:"52px",className:"w-full rounded-[10px]"})]}),!l.values.official&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"flex flex-col gap-[6px] w-full max-w-[515px]",children:[e.jsx(a,{color:"#ABA9B1",fontSize:"14px",fontWeight:"400",lineHeight:"20px",children:"Source pattern"}),e.jsx(r,{className:"flex flex-col gap-2 w-full",children:e.jsx(F,{show:A||N,component:e.jsx(w,{fullWidth:!0,id:"sourcePattern",name:"sourcePattern",type:"text",placeholder:"Enter Source URL",variant:"outlined",value:l.values.sourcePattern,onChange:l.handleChange,onBlur:l.handleBlur,error:l.touched.sourcePattern&&!!l.errors.sourcePattern,helperText:l.touched.sourcePattern&&l.errors.sourcePattern}),height:"52px",className:"w-full rounded-[10px]"})})]}),e.jsxs(r,{className:"flex flex-col gap-[6px]",children:[e.jsxs(r,{className:q("flex flex-row justify-between max-w-[515px]",{"border border-dashed border-[#3D3B42] rounded-[10px] py-[11px] pl-[16px] pr-[12px]":l.values.versionSources}),children:[e.jsx(a,{color:"#ABA9B1",fontSize:"14px",fontWeight:"400",lineHeight:"20px",children:"Version sources"}),e.jsx(r,{children:e.jsxs(G,{sx:{gap:"4px",fontSize:"12px",fontWeight:"500",lineHeight:"normal",border:"none",padding:"0px",minHeight:"0px",height:"fit-content",":hover":{color:"#4CDB9D !important"}},onClick:()=>{const t=[...l.values.versionSources,{version:"",source:""}];l.setFieldValue("versionSources",g.cloneDeep(t))},children:[e.jsx(X,{size:"16px",color:"currentColor"}),"Add source"]})})]}),e.jsx(r,{className:"flex flex-col gap-[6px] rounded-lg",children:g.map(l.values.versionSources,(o,t)=>{var x,f,c,h,P,C,k,E,z;return e.jsxs(r,{className:"flex flex-col gap-[2px]",children:[e.jsxs(r,{className:"flex flex-row gap-2 items-center group",children:[e.jsxs(r,{className:"flex flex-row gap-[6px] w-full max-w-[515px]",children:[e.jsx(w,{fullWidth:!0,id:`versionSources.${t}`,name:`versionSources.${t}.version`,type:"text",placeholder:"Enter version",varient:"outlined",value:o.version,onBlur:l.handleBlur,onChange:p=>{let m=[...l.values.versionSources];m[t].version=p.target.value,l.setFieldValue("versionSources",g.cloneDeep(m))},error:!!((f=(x=l.errors.versionSources)==null?void 0:x[t])!=null&&f.version)&&l.touched.versionSources}),e.jsx(w,{fullWidth:!0,id:`versionSources.${t}`,name:`versionSources.${t}.source`,type:"text",placeholder:"Enter source",varient:"outlined",value:o.source,onBlur:l.handleBlur,onChange:p=>{let m=[...l.values.versionSources];m[t].source=p.target.value,l.setFieldValue("versionSources",g.cloneDeep(m))},error:!!((h=(c=l.errors.versionSources)==null?void 0:c[t])!=null&&h.source)&&l.touched.versionSources})]}),e.jsx(r,{className:"hidden delete-button group-hover:flex",children:e.jsx(le,{sx:{borderRadius:"8px",padding:"4px"},onClick:()=>{let p=[...l.values.versionSources];p=p.filter((m,$)=>$!==t),l.setFieldValue("versionSources",g.cloneDeep(p))},children:e.jsx(Y,{size:"20px",color:"#E56852"})})})]}),l.touched.versionSources&&((P=l.errors.versionSources)!=null&&P[t])?e.jsx(a,{fontSize:"12px",fontWeight:"400",color:"#EF4444",lineHeight:"20px",children:((k=(C=l.errors.versionSources)==null?void 0:C[t])==null?void 0:k.version)||((z=(E=l.errors.versionSources)==null?void 0:E[t])==null?void 0:z.source)}):null]})})})]})]})]})})})})})]})]})}const fe=[{key:"name",label:"Plugin name",align:"start",width:80},{key:"type",label:"Type",align:"start",width:40},{key:"sourcePattern",label:"Source pattern",align:"start",width:10},{key:"actions",label:"Actions",align:"end",width:10}];function me(){const[n,i]=j.useState(null),u=async()=>(await D.get("/plugin-artifacts")).data,{data:v,isLoading:S,isRefetching:l}=_({queryKey:["get-all-plugins"],queryFn:u,staleTime:0}),y=j.useCallback((s,d)=>{switch(s[d],d){case"name":return e.jsx("span",{className:"text-[#ADADAD]",children:s.name});case"type":return e.jsx(r,{className:q("flex flex-row w-fit items-center gap-2 px-[7px] py-[5px] rounded-3xl capitalize",{"bg-[#52D97F21] text-[#52D97F]":s.official,"bg-[#A480FF21] text-[#A480FF]":!s.official}),children:s.official?"Official":"Custom"});case"sourcePattern":return e.jsx("span",{className:"text-[#ADADAD]",children:s.official?"-":s.sourcePattern});case"actions":return e.jsx(r,{className:"flex justify-end",children:e.jsx(B,{onClick:()=>{i(s.name)},icon:O,filledIcon:O,disabled:s.official,children:"Edit"})});default:return null}},[v,S,l]);return e.jsxs(e.Fragment,{children:[n&&e.jsx(L,{isOpen:!!n,onOpenChange:()=>i(null),pluginName:n}),e.jsxs(se,{removeWrapper:!0,layout:"auto",isHeaderSticky:!0,classNames:{base:"max-h-[calc(var(--window-height)-212px)] h-[calc(var(--window-height)-212px)] overflow-scroll",th:"text-[#9D90BB] text-xs bg-[#161616] first:rounded-l-xl last:rounded-r-xl",td:"text-sm font-normal leading-normal border-b-[0.5px] border-solid border-[#1E1E1E] first:rounded-l-xl last:rounded-r-xl",tr:"[&>th]:h-[42px] [&>td]:h-[60px] hover:bg-[#28282A]"},children:[e.jsx(te,{columns:fe,children:s=>e.jsx(oe,{align:s.align,width:s.width,children:s.label},s.key)}),e.jsx(ne,{items:v||[],isLoading:S,loadingContent:e.jsx(ce,{color:"secondary"}),emptyContent:e.jsxs(r,{className:"flex flex-col items-center h-full w-full gap-4",children:[e.jsx(r,{className:"flex items-center justify-center bg-[#1A1A1A] rounded-[10px] size-12",marginTop:"100px",children:e.jsx(re,{size:"24px",color:"#ADADAD"})}),e.jsxs(r,{className:"flex flex-col items-center gap-[5px]",children:[e.jsx(a,{color:"#F1F0F0",textAlign:"center",fontFamily:"Manrope",fontSize:"16px",fontWeight:"400",lineHeight:"18px",letterSpacing:"0.32px",children:"No plugin available to display"}),e.jsx(a,{maxWidth:"298px",color:"#A6A6A6",textAlign:"center",fontFamily:"Manrope",fontSize:"12px",fontWeight:"400",lineHeight:"normal",letterSpacing:"0.24px",children:"There are no plugins to display right now. Please add one to the display list."})]})]}),children:s=>e.jsx(ie,{children:d=>e.jsx(ae,{children:y(s,d)})},s.name)})]})]})}function ol({}){return[{title:"Plugins"},{name:"description",content:"Welcome to Hyperflex"}]}function he(){const[n,i]=j.useState(!1),u=M();return e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"flex px-8",children:e.jsx(T,{items:[{label:"Go back",icon:e.jsx(V,{size:"14px",color:"currentColor"}),onClick:()=>u(-1)},{label:"Plugins",color:"#BDA0FF"}]})}),e.jsxs(r,{className:"flex px-8 pt-4 h-full w-full",children:[n&&e.jsx(L,{isOpen:n,onOpenChange:()=>i(!1)}),e.jsx(r,{className:"flex p-px h-full w-full rounded-2xl",sx:{background:"radial-gradient(#6E687C, #1D1D1D)"},children:e.jsxs(r,{className:"flex flex-col gap-4 h-full w-full bg-[#0D0D0D] rounded-[15px] px-6 py-4",children:[e.jsxs(r,{className:"flex flex-row gap-2 justify-between items-center pl-2",children:[e.jsx(a,{color:"#FFF",fontFamily:"Manrope",fontSize:"14px",fontWeight:"600",lineHeight:"22px",children:"Plugins"}),e.jsxs(B,{sx:{background:"#0D0D0D"},padding:"8px 16px",onClick:()=>i(!0),children:[e.jsx(ue,{size:"14px",color:"currentColor"}),"Add plugin"]})]}),e.jsx(r,{className:"flex",children:e.jsx(me,{})})]})})]})]})}const nl=R(he);export{nl as default,ol as meta};
