#!/usr/bin/env python3
import requests
import getpass
import json
import sys

def main():
    print("Create New User")
    username = input("Enter username: ").strip()
    password = getpass.getpass("Enter password: ").strip()

    if not username or not password:
        print("❌ Username and password cannot be empty.")
        sys.exit(1)

    url = "https://localhost:8080/api/v1/auth/signup"
    payload = {"username": username, "password": password}

    try:
        response = requests.post(
            url,
            json=payload,
            verify=False,  # same as -k in curl
            headers={"Content-Type": "application/json"}
        )
        print(f"\n✅ Status: {response.status_code}")
        try:
            print(json.dumps(response.json(), indent=2))
        except ValueError:
            print(response.text)
    except requests.exceptions.RequestException as e:
        print("❌ Request failed:", e)
        sys.exit(1)

if __name__ == "__main__":
    main()
